# AI Flashcard App: Database Schema (Cloud Firestore)

This document is the official "blueprint" for our Firestore database. All team members **must** use these exact collection and field names to ensure our components work together.

**Data Model Philosophy:**
* **`decks`:** A collection to store the *content* (flashcards, quiz questions) and *summary data* (last score) for a study deck.
* **`quizAttempts`:** A collection to store the *history* of every quiz taken. This is our "Report Card" data.
* **`users`:** A collection to mirror our Firebase Auth users and store any extra profile information.

---

## 1. Collection: `users`

This collection stores public-facing information for our users. The Document ID **must** be the same as the User ID (`uid`) provided by Firebase Authentication.

**Path:** `users/{userId}`

**Created by:** **Member 2 (UX Lead)**, once, right after a new user signs up.

**Fields:**
* `email`: (String) The user's email (copied from Firebase Auth).
* `displayName`: (String) The user's name (can be added later via a "Profile" page).
* `createdAt`: (Timestamp) The date the user joined.

---

## 2. Collection: `decks`

This is the main collection for our app. It stores all the content generated by the AI and the summary analytics for the dashboard.

**Path:** `decks/{deckId}` (Firestore will auto-generate the `deckId`).

**Created by:** **Member 2 (UX Lead)**, after the AI functions (from Member 1) successfully return data.

**Read by:** **Member 3 (Analytics Lead)**, to populate the "Perfect/Practise More" dashboard.

**Updated by:** **Member 3 (Analytics Lead)**, who will update the `lastAccuracy` field *every time* a quiz is completed.

**Fields:**
* `ownerId`: (String) **[CRITICAL]** The `uid` of the user who owns this deck. This is how we query for a user's decks.
* `name`: (String) The "Deck Name" the user entered (e.g., "PL/SQL Basics").
* `createdAt`: (Timestamp) The date the deck was created (for sorting).
* `lastAccuracy`: (Number) The percentage score (e.g., `85`) of the *most recent* quiz attempt.
    * **Default:** `null` or `0` (This is how Member 3 will know to put it in the "Practise More" column).
* `flashcards`: (Array) A list of flashcard objects (maps).
    * **Object Structure:** `{ question: "string", answer: "string" }`
* `quiz`: (Array) A list of quiz question objects (maps).
    * **Object Structure:** `{ question: "string", options: ["Array", "of", "strings"], answer: "The correct string" }`
* `sourceTextLength`: (Number) The length of the text used to generate this deck (good for metadata).

---

## 3. Collection: `quizAttempts`

This collection is our "Report Card." Every single time any user completes a quiz, we will create **one new document** in this collection.

**Path:** `quizAttempts/{attemptId}` (Firestore will auto-generate the `attemptId`).

**Created by:** **Member 3 (Analytics Lead)**, every time a user submits a quiz.

**Read by:** **Member 3 (Analytics Lead)**, to build the "Report Card" history page for a specific deck.

**Fields:**
* `userId`: (String) **[CRITICAL]** The `uid` of the user who took the quiz.
* `deckId`: (String) **[CRITICAL]** The ID of the deck this attempt belongs to. This is how we query for the report card history.
* `timestamp`: (Timestamp) **[CRITICAL]** The exact date and time the quiz was completed. This is for sorting the report card.
* `score`: (Number) The number of questions the user got right (e.g., `8`).
* `totalQuestions`: (Number) The total number of questions in the quiz (e.g., `10`).
* `accuracy`: (Number) The final percentage (e.g., `80`), calculated as `(score / totalQuestions) * 100`.
* `answers`: (Array) *(Optional but recommended)* A list of the user's answers, to allow them to review their attempt.
    * **Object Structure:** `{ question: "string", selectedAnswer: "string", correctAnswer: "string" }`
